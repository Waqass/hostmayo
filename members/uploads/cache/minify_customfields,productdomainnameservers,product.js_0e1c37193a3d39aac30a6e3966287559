var customFields=function(){var ctrl;var customFieldsAdded=[];var allFieldsDisabled=true;var selectListeners=[];var clickListeners=[];var deleteRowListeners=[];var unique_id=0;return{load:function(fields,renderer,postload,unique){allFieldsDisabled=true;if(!unique)unique=false
for(var iterator=0;iterator<fields.length;iterator++){customFields.getMarkup(fields[iterator],renderer,unique);}
if(postload)postload();},getMarkup:function(currentFieldData,renderer,unique){var width;unique_id++;var isComboType=false;var allowBlankValue=true;var isDisabled=true;var selectFirstOnBlank=true;ctrl=null;if(currentFieldData.isrequired==1){allowBlankValue=false;}
if(currentFieldData.ischangeable==1){isDisabled=false;allFieldsDisabled=false;}
if(typeof(currentFieldData.selectfirstonblank)!="undefined"){if(!currentFieldData.selectfirstonblank){selectFirstOnBlank=false;}}
var createHiddenTypeField=false;var controlid=currentFieldData.id;if($.isNumeric(currentFieldData.id)||currentFieldData.fieldtype==50){controlid='CT_'+currentFieldData.id;createHiddenTypeField=true;}
currentFieldData.field_name=controlid;if(unique){currentFieldData.field_id=controlid+"_"+unique_id;}else{currentFieldData.field_id=controlid;}
currentFieldData.name=lang(currentFieldData.name);var metaValue='';switch(currentFieldData.fieldtype){case'65':currentFieldData.is_password=true;case'63':case'64':case'2':case'14':case'4':case'3':case'5':case'13':case'11':case'12':case'7':case'0':this.renderTextField(controlid,currentFieldData,isDisabled,renderer);break;case'47':this.renderVATField(controlid,currentFieldData,isDisabled,renderer);break;case'10':this.renderTextArea(controlid,currentFieldData,isDisabled,renderer);break;case'15':this.renderDate(controlid,currentFieldData,isDisabled,renderer);break;case'16':case'1':currentFieldData.dropdownoptions=[[0,"No"],[1,"Yes"]];this.renderDropDown(controlid,currentFieldData,isDisabled,renderer);isComboType=true;break;case'8':case'30':this.renderDropDown(controlid,currentFieldData,isDisabled,renderer);isComboType=true;break;case'6':case'9':this.renderDropDown(controlid,currentFieldData,isDisabled,renderer);isComboType=true;break;case'49':this.renderButton(controlid,currentFieldData,isDisabled,renderer);break;case'52':this.renderHidden(controlid,currentFieldData,isDisabled,renderer);break;case'54':this.renderTextField(controlid,currentFieldData,isDisabled,renderer);$('#'+controlid).addClass('number');break;case'50':this.renderHostname(controlid,currentFieldData,isDisabled,renderer);break;case'55':this.renderNameserver(controlid,currentFieldData,isDisabled,renderer);break;case'53':this.renderCheckBox(controlid,currentFieldData,isDisabled,renderer);break;case'subdomain':this.renderSubDomain(controlid,currentFieldData,isDisabled,renderer);break;default:break;}
if(createHiddenTypeField){hiddenField={};hiddenField.value=currentFieldData.fieldtype;hiddenField.id='CTT_'+currentFieldData.id;hiddenField.name=currentFieldData.id;hiddenField.additional_class="customfield_hidden";hiddenField.field_name=hiddenField.id;if(unique){hiddenField.field_id=hiddenField.id+"_"+unique_id;}else{hiddenField.field_id=hiddenField.id;}
this.renderHidden(hiddenField.id,hiddenField,false,renderer);}
if((currentFieldData.listener)&&(currentFieldData.listener.onclick)){clickListeners[controlid]=currentFieldData.listener.onclick;$('#'+controlid).bind('click',function(){eval(clickListeners[this.id]+'()');});}
if((currentFieldData.listener)&&(currentFieldData.listener.onselect)){selectListeners[controlid]=currentFieldData.listener.onselect;$('#'+controlid).bind('change',function(){eval(selectListeners[this.id]+'()');});}},renderCheckBox:function(controlid,currentFieldData,isDisabled,renderer){var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-mincheck="1" parsley-required="true"':'';var field='<label class="checkbox"><input id="'+controlid+'" name="'+currentFieldData.id+'" value="'+currentFieldData.value+'" type="checkbox" '+required+' />'+currentFieldData.name+'</label>';var ctrl=$(field);renderer(ctrl);},renderHidden:function(controlid,currentFieldData,isDisabled,renderer){if(typeof currentFieldData.name==='undefined'){currentFieldData.name=currentFieldData.id;}
var label='<span for="'+controlid+'" class="customfield_hidden" style="display:none;">'+currentFieldData.name+'</span>';var field='<input id="'+controlid+'" name="'+currentFieldData.name+'" value="'+currentFieldData.value+'" type="hidden" />';var ctrl=$(label+field);renderer(ctrl);},renderButton:function(controlid,currentFieldData,isDisabled,renderer){hidden='';if(currentFieldData.ishidden){hidden='display: none';}
var width=(currentFieldData.width)?currentFieldData.width:330;var ctrl=$("<div id='"+controlid+"_wrapper'><button id='"+controlid+"' type='button' style='margin-top:20px;width:"+width+"px; "+hidden+"' class='btn'><span>"+lang(currentFieldData.value)+"</span></button></div>");renderer(ctrl);},renderDate:function(controlid,currentFieldData,isDisabled,renderer)
{var options="",field="",ctrl,dateformat;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:288;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden=(currentFieldData.ishidden)?"display:none;":"";var name=currentFieldData.name;if(currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';if(currentFieldData.value&&currentFieldData.value!==''&&currentFieldData.value!=='00/00/0000'){}else{currentFieldData.value='No date selected';}
if(clientexec.dateFormat==="d/m/Y"){dateformat="dd/mm/yyyy";}else{dateformat="mm/dd/yyyy";}
field='<div style="'+hidden+'" class="input-append date" id="'+currentFieldData.field_id+'" data-date="'+currentFieldData.value+'" >';field+='<input name="'+controlid+'"" style="display: inline;width:'+width+'px" class="span2 disableDatePickerAutoLoad" type="text" value="'+currentFieldData.value+'" readonly>';field+='<span class="add-on"><i class="icon-calendar"></i></span>';field+='</div>';if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
var arr=controlid.split("_");var ctt="<input type='hidden' name='CTT_"+arr[1]+"' value='15'>";ctrl=$(label+field+ctt);renderer(ctrl);$('#'+currentFieldData.field_id).datepicker({format:dateformat,autoclose:true});},renderNameserver:function(controlid,currentFieldData,isDisabled,renderer)
{var disabledtext=(isDisabled)?'disabled="disabled"':"";var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden=(currentFieldData.ishidden)?"display:none;":"";var label='<label  class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+currentFieldData.name+'</label>';var field='<input class="nameserver" style="width:250px;'+hidden+'" '+required+' value="'+currentFieldData.value+'" '+disabledtext+' type="text" id="'+controlid+'" name="'+controlid+'" />';var postdiv='<button type="button" name="'+controlid+'_nameserverdelete" id="'+controlid+'_nameserverdelete" style="margin-left:10px;'+hidden+'" class="rich-button btn" onclick="nameservers_deleteaddress(this);"><span>Delete</span></button>';var ctrl=$(label+field+postdiv);renderer(ctrl);},renderHostname:function(controlid,currentFieldData,isDisabled,renderer)
{var hosttype="",hostname="",address="",ctrl,options="",prediv="",postdiv="";var disabledtext=(isDisabled)?'disabled="disabled"':"";var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden="";var drop_class="";if(currentFieldData.ishidden){hidden="display:none;";drop_class="disableSelect2AutoLoad";}
selected=(currentFieldData.value.hosttype=="A")?"selected":"";options='<option value="A" '+selected+'>A</option>';selected=(currentFieldData.value.hosttype=="AAAA")?"selected":"";options+='<option value="AAAA" '+selected+'>AAAA</option>';selected=(currentFieldData.value.hosttype=="MXE")?"selected":"";options+='<option value="MXE" '+selected+'>MXE</option>';selected=(currentFieldData.value.hosttype=="MX")?"selected":"";options+='<option value="MX" '+selected+'>MX</option>';selected=(currentFieldData.value.hosttype=="CNAME")?"selected":"";options+='<option value="CNAME" '+selected+'>CNAME</option>';selected=(currentFieldData.value.hosttype=="URL")?"selected":"";options+='<option value="URL" '+selected+'>URL</option>';selected=(currentFieldData.value.hosttype=="FRAME")?"selected":"";options+='<option value="FRAME" '+selected+'>FRAME</option>';selected=(currentFieldData.value.hosttype=="TXT")?"selected":"";options+='<option value="TXT" '+selected+'>TXT</option>';hostname='<input style="width:176px;margin-right:3px;height:18px;margin-bottom:1px;'+hidden+'" '+required+' value="'+currentFieldData.value.hostname+'" '+disabledtext+' type="text" id="hostname_'+controlid+'" class="hostname" name="hostname_'+controlid+'"  placeholder="Name" />';hosttype='<select '+disabledtext+' '+required+' id="hosttype_'+controlid+'" class="hosttype '+drop_class+'" name="hosttype_'+controlid+'" style="width:90px;'+hidden+'">'+options+'</select>';address='<input style="margin-left:3px;width:176px;height:18px;margin-bottom:1px;'+hidden+'" '+required+" value='"+currentFieldData.value.address+"' "+disabledtext+' type="text" id="hostaddress_'+controlid+'" class="hostaddress" name="hostaddress_'+controlid+'" placeholder="Address" />';if(!currentFieldData.ishidden){prediv="<div id='hostdivider_"+controlid+"' style='padding-top:10px;'></div>";buttonDisabled='';if(isDisabled){buttonDisabled='disabled';}
postdiv='<button type="button" name="'+controlid+'_hostdelete" id="'+controlid+'_hostdelete" style="margin-left:10px;" class="rich-button btn" onclick="hostrecords_deleteaddress(this);" '+buttonDisabled+'><span>Delete</span></button>';}
ctrl=$(prediv+hostname+hosttype+address+postdiv);renderer(ctrl);packagemanager.newhostrecordid++;if(!currentFieldData.ishidden){ctrlid='#hosttype_'+controlid;$(ctrlid).select2({minimumResultsForSearch:10,width:'resolve'});}},renderTextArea:function(controlid,currentFieldData,isDisabled,renderer)
{var field="",ctrl;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:315;var height=(currentFieldData.height)?currentFieldData.height:100;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var name=currentFieldData.name;if(currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';field='<textarea class="type_'+currentFieldData.fieldtype+' disableSelect2AutoLoad" '+disabledtext+' '+required+' id="'+controlid+'" name="'+controlid+'" style="width:'+width+'px; height:'+height+'px">'+currentFieldData.value+'</textarea>';if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
ctrl=$(label+field);renderer(ctrl);},renderDropDown:function(controlid,currentFieldData,isDisabled,renderer)
{var options="",field="",ctrl,option_value,option_name;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:330;var showlabel=(typeof(currentFieldData.showlabel)!="undefined")?currentFieldData.showlabel:true;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var showcheckboxes=(typeof(currentFieldData.showcheckboxes)!="undefined")?currentFieldData.showcheckboxes:false;name=currentFieldData.name;if(!showcheckboxes&&currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}else if(showcheckboxes){options="<div class='field-description'>"+currentFieldData.description+"</div>";}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';var value_is_in_dropdown=false;$.each(currentFieldData.dropdownoptions,function(index,object){option_value=object[0];option_name=object[1];if(showcheckboxes){selected=(option_value==currentFieldData.value)?"checked":"";options+='<label  class="customfield_label radio"><input type="radio" '+selected+' name="'+controlid+'" value="'+option_value+'"> '+option_name+'</label>';}else{selected=(option_value==currentFieldData.value)?"selected":"";options+="<option value='"+option_value+"' "+selected+">"+option_name+"</option>";}
if(selected!=""){value_is_in_dropdown=true;}});if(!value_is_in_dropdown&&currentFieldData.value!=""){if(showcheckboxes){options+='<label  class="customfield_label radio"><input type="radio" checked name="'+controlid+'" value="'+currentFieldData.value+'"> '+currentFieldData.value+'</label>';}else{options+="<option value='"+currentFieldData.value+"' selected>"+currentFieldData.value+"</option>";}}
if(showcheckboxes){field="<fieldset>"+options+"</fieldset>";}else{field='<select tabindex="1" class="type_'+currentFieldData.fieldtype+' disableSelect2AutoLoad" '+disabledtext+' '+required+' id="'+currentFieldData.field_id+'" name="'+controlid+'" style="width:'+width+'px">'+options+'</select>';}
if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
if(showlabel){ctrl=$(label+field);}else{ctrl=$(field);}
renderer(ctrl);ctrlid='#'+currentFieldData.field_id;if(!showcheckboxes){$(ctrlid).select2({minimumResultsForSearch:10,width:'resolve'});if(currentFieldData.ishidden){$(ctrlid).select2('container').hide();}}},renderTextField:function(controlid,currentFieldData,isDisabled,renderer){var is_password=(currentFieldData.is_password)?currentFieldData.is_password:false;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:315;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden=(currentFieldData.ishidden)?"display:none;":"";var additional_validation=(currentFieldData.validation_type)?'data-type="'+currentFieldData.validation_type+'"':'';var name=currentFieldData.name;if(currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';if(typeof(currentFieldData.value)=="undefined"){currentFieldData.value="";}
if(currentFieldData.value!==null){currentFieldData.value=currentFieldData.value.replace(/"/g,'&quot;');}
var field='<input style="width:'+width+'px;'+hidden+'" '+required+' '+additional_validation+' class="type_'+currentFieldData.fieldtype+'" value="'+currentFieldData.value+'" '+disabledtext+' type="'+((is_password)?"password":"text")+'" id="'+controlid+'" name="'+controlid+'" />';if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
var ctrl=$(label+field);renderer(ctrl);},renderSubDomain:function(controlid,currentFieldData,isDisabled,renderer){var width=(currentFieldData.width)?currentFieldData.width:315;var name=currentFieldData.name;var label='<table><tr><td><label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';var field='<input pattern="^([-0-9A-Za-z]+)$" data-required="true" parsley-required="true" style="width:'+width+'px;"class="type_'+currentFieldData.fieldtype+'" type="text" id="'+controlid+'" name="'+controlid+'" onchange="validateSubDomain(\''+controlid+'\');"/></td>';var field=field+'<td style="padding-top:26px"  valign="top">&nbsp; . &nbsp; <select name="subdomaintld_'+controlid+'" id="subdomaintld_'+controlid+'" onchange="validateSubDomain(\''+controlid+'\');">';$.each(currentFieldData.subdomains,function(index,value){field=field+'<option value="'+value+'">'+value+'</option>';})
field=field+'</select></td></tr></table>';var ctrl=$(label+field);renderer(ctrl);},renderVATField:function(controlid,currentFieldData,isDisabled,renderer){var is_password=(currentFieldData.is_password)?currentFieldData.is_password:false;var disabledtext=(isDisabled)?'disabled="disabled"':"";var width=(currentFieldData.width)?currentFieldData.width:293;var required=(currentFieldData.isrequired&&currentFieldData.isrequired==true)?'data-required="true" parsley-required="true"':'';var hidden=(currentFieldData.ishidden)?"display:none;":"";var additional_validation=(currentFieldData.validation_type)?'data-type="'+currentFieldData.validation_type+'"':'';var name=currentFieldData.name;if(currentFieldData.description){name='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+name+'</span>';}
var label='<label class="customfield_label" for="'+controlid+'" style="display:'+((currentFieldData.ishidden)?"none":"")+'">'+name+'</label>';if(typeof(currentFieldData.value)=="undefined"){currentFieldData.value="";}
var field='<span id="vat_country"></span>&nbsp;&nbsp;<input style="width:'+width+'px;'+hidden+'" '+required+' '+additional_validation+' class="type_'+currentFieldData.fieldtype+'" value="'+currentFieldData.value+'" '+disabledtext+' type="'+((is_password)?"password":"text")+'" id="'+controlid+'" name="'+controlid+'" />';if(currentFieldData.description){field='<span data-toggle="popover-hover" data-html="true" data-placement="top" title="'+currentFieldData.name+'" data-content="'+currentFieldData.description+'" class="tip-target">'+field+'</span>';}
var message0='<div id="vat_validating" style="display:none">Validating...</div>';var message1='<div id="vat_valid" style="display:none">Valid VAT Number</div>';var message2='<div id="vat_invalid" style="display:none">Invalid VAT Number.&nbsp;<a href="javascript:validate_vat();"><font color=blue>Retry</font></a></div>';var message3='<div id="vat_error" style="display:none">Unable to validate at the moment.&nbsp;<a href="javascript:validate_vat();"><font color=blue>Retry</font></a></div>';var ctrl=$('<span id="VAT'+controlid+'" name="VAT'+controlid+'" style="display:none">'+label+field+message0+message1+message2+message3+'</span>');renderer(ctrl);},getAllFieldsDisabled:function(){return allFieldsDisabled;},getCustomFieldsAdded:function(){return customFieldsAdded;},resetCustomFields:function(){customFieldsAdded=[];}};}();;$(document).ready(function(){customFields.load(nameservers.jsonFields,function(data){$('#nameservers-div').append(data);},function(){clientexec.postpageload('#nameservers-div');$('.form-actions').show();});});$('#update-button').click(function(){$.post('index.php?fuse=clients&controller=products&action=savedomainnameservers',$('#nameservers').serialize(),function(data){var json=ce.parseResponse(data);});});function nameservers_ChangeUseDefaults()
{var useDefaults=$('#ns_usedefaults').val();if(useDefaults==="0"){$('#ns_usedefaults').nextUntil('#addnameserver_wrapper').show();}else{$('#ns_usedefaults').nextUntil('#addnameserver_wrapper').hide();}}
function nameservers_addnameserver()
{var useDefaults=$('#ns_usedefaults').val();if(useDefaults==="1"){RichHTML.error(lang('The setting <strong>Use Defaults</strong> must be set to No if you want to add your own Name Server'));return;}
var nth=$('input.nameserver').length;var serverName='Name Server '+nth;var hostname=$($('input.nameserver')[0]).clone().show();hostname.attr('id',"ns_"+nth);hostname.attr('name',"ns_"+nth);hostname.val("");var label=$('label[for="blankrecord"]').clone().show();label.attr('for',"ns_"+nth);label.html("Name Server "+nth);$('#addnameserver').parent().before(label);$('#addnameserver').parent().before(hostname);$('#addnameserver').parent().before('<button type="button" name="ns_'+nth+'_nameserverdelete" id="ns_'+nth+'_nameserverdelete" style="margin-left:10px;" class="rich-button btn" onclick="nameservers_deleteaddress(this);"><span>Delete</span></button>');}
function nameservers_deleteaddress(row)
{id=row.id.split("_");$('label[for="ns_'+id[1]+'"]').remove();$("#ns_"+id[1]).remove();$("#ns_"+id[1]+"_nameserverdelete").remove();};var productview=productview||{};productview.callPluginAction=function(pluginAction,packageId)
{RichHTML.mask();$.ajax({url:'index.php?fuse=clients&action=callpluginaction',success:function(xhr){var json=ce.parseResponse(xhr);RichHTML.unMask();},data:{id:packageId,actioncmd:pluginAction}});};$('#passwordChange').click(function(e){e.preventDefault();RichHTML.prompt(lang('Please enter a new password'),{},function(returnVal){if(returnVal.btn==lang('Cancel')){return;}
if($.trim(returnVal.elements.value)!==""){password=returnVal.elements.value;$.post('index.php?fuse=clients&controller=products&action=updatehostingpassword',{id:productview.package_id,password:password},function(data){ce.parseResponse(data);});}});});